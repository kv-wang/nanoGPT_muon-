logs/b07f75e3-b3a5-4b61-951b-65f850d2285a.txt
begin training
  2%|█▊                                                                                                   | 31/1771 [00:04<03:29,  8.29it/s]
step:1/1770 train_time:348ms step_avg:347.83ms
step:2/1770 train_time:467ms step_avg:233.39ms
step:3/1770 train_time:583ms step_avg:194.45ms
step:4/1770 train_time:703ms step_avg:175.81ms
step:5/1770 train_time:824ms step_avg:164.87ms
step:6/1770 train_time:948ms step_avg:158.00ms
step:7/1770 train_time:1072ms step_avg:153.17ms
step:8/1770 train_time:1189ms step_avg:148.66ms
step:9/1770 train_time:1316ms step_avg:146.24ms
step:10/1770 train_time:1440ms step_avg:143.96ms
step:11/1770 train_time:1561ms step_avg:141.93ms
step:12/1770 train_time:1689ms step_avg:140.74ms
step:13/1770 train_time:1804ms step_avg:138.76ms
step:14/1770 train_time:1923ms step_avg:137.32ms
step:15/1770 train_time:2041ms step_avg:136.07ms
step:16/1770 train_time:2168ms step_avg:135.48ms
step:17/1770 train_time:2294ms step_avg:134.93ms
step:18/1770 train_time:2413ms step_avg:134.08ms
step:19/1770 train_time:2535ms step_avg:133.41ms
step:20/1770 train_time:2669ms step_avg:133.45ms
step:21/1770 train_time:2793ms step_avg:132.99ms
step:22/1770 train_time:2925ms step_avg:132.93ms
step:23/1770 train_time:3057ms step_avg:132.90ms
step:24/1770 train_time:3190ms step_avg:132.92ms
step:25/1770 train_time:3310ms step_avg:132.39ms
step:26/1770 train_time:3431ms step_avg:131.96ms
step:27/1770 train_time:3547ms step_avg:131.37ms
step:28/1770 train_time:3662ms step_avg:130.80ms
step:29/1770 train_time:3782ms step_avg:130.42ms
step:30/1770 train_time:3911ms step_avg:130.35ms
step:31/1770 train_time:4027ms step_avg:129.89ms
step:32/1770 train_time:4146ms step_avg:129.55ms
step:33/1770 train_time:4266ms step_avg:129.27ms
step:34/1770 train_time:4394ms step_avg:129.24ms
step:35/1770 train_time:4524ms step_avg:129.25ms
step:36/1770 train_time:4655ms step_avg:129.30ms
step:37/1770 train_time:4786ms step_avg:129.36ms
step:38/1770 train_time:4923ms step_avg:129.54ms
step:39/1770 train_time:5054ms step_avg:129.59ms
step:40/1770 train_time:5184ms step_avg:129.59ms
step:41/1770 train_time:5318ms step_avg:129.72ms
step:42/1770 train_time:5447ms step_avg:129.68ms
step:43/1770 train_time:5582ms step_avg:129.81ms
step:44/1770 train_time:5721ms step_avg:130.02ms
step:45/1770 train_time:5853ms step_avg:130.07ms
step:46/1770 train_time:5981ms step_avg:130.02ms
step:47/1770 train_time:6104ms step_avg:129.88ms
step:48/1770 train_time:6226ms step_avg:129.70ms
step:49/1770 train_time:6357ms step_avg:129.73ms
step:50/1770 train_time:6483ms step_avg:129.66ms
step:51/1770 train_time:6616ms step_avg:129.73ms
step:52/1770 train_time:6748ms step_avg:129.77ms
step:53/1770 train_time:6888ms step_avg:129.97ms
step:54/1770 train_time:7019ms step_avg:129.98ms
step:55/1770 train_time:7151ms step_avg:130.02ms
step:56/1770 train_time:7287ms step_avg:130.12ms
step:57/1770 train_time:7416ms step_avg:130.11ms
step:58/1770 train_time:7547ms step_avg:130.11ms
step:59/1770 train_time:7675ms step_avg:130.08ms
step:60/1770 train_time:7805ms step_avg:130.08ms
step:61/1770 train_time:7941ms step_avg:130.18ms
step:62/1770 train_time:8071ms step_avg:130.18ms
step:63/1770 train_time:8201ms step_avg:130.18ms
step:64/1770 train_time:8340ms step_avg:130.31ms
step:65/1770 train_time:8457ms step_avg:130.11ms
step:66/1770 train_time:8579ms step_avg:129.99ms
step:67/1770 train_time:8695ms step_avg:129.77ms
step:68/1770 train_time:8823ms step_avg:129.75ms
step:69/1770 train_time:8943ms step_avg:129.61ms
step:70/1770 train_time:9067ms step_avg:129.53ms
step:71/1770 train_time:9197ms step_avg:129.54ms
step:72/1770 train_time:9318ms step_avg:129.42ms
step:73/1770 train_time:9443ms step_avg:129.36ms
step:74/1770 train_time:9566ms step_avg:129.27ms
step:75/1770 train_time:9683ms step_avg:129.11ms
step:76/1770 train_time:9803ms step_avg:128.99ms
step:77/1770 train_time:9927ms step_avg:128.93ms
step:78/1770 train_time:10052ms step_avg:128.88ms
step:79/1770 train_time:10169ms step_avg:128.72ms
step:80/1770 train_time:10290ms step_avg:128.62ms
step:81/1770 train_time:10410ms step_avg:128.52ms
step:82/1770 train_time:10536ms step_avg:128.49ms
step:83/1770 train_time:10658ms step_avg:128.41ms
step:84/1770 train_time:10777ms step_avg:128.30ms
step:85/1770 train_time:10895ms step_avg:128.18ms
step:86/1770 train_time:11013ms step_avg:128.06ms
step:87/1770 train_time:11137ms step_avg:128.02ms
step:88/1770 train_time:11260ms step_avg:127.95ms
step:89/1770 train_time:11387ms step_avg:127.95ms
step:90/1770 train_time:11516ms step_avg:127.95ms
step:91/1770 train_time:11642ms step_avg:127.94ms
step:92/1770 train_time:11762ms step_avg:127.85ms
step:93/1770 train_time:11883ms step_avg:127.77ms
step:94/1770 train_time:12008ms step_avg:127.75ms
step:95/1770 train_time:12137ms step_avg:127.76ms
step:96/1770 train_time:12258ms step_avg:127.68ms
step:97/1770 train_time:12379ms step_avg:127.61ms
step:98/1770 train_time:12496ms step_avg:127.51ms
step:99/1770 train_time:12620ms step_avg:127.47ms
step:100/1770 train_time:12738ms step_avg:127.38ms
step:101/1770 train_time:12856ms step_avg:127.28ms
step:102/1770 train_time:12981ms step_avg:127.26ms
step:103/1770 train_time:13104ms step_avg:127.22ms
step:104/1770 train_time:13226ms step_avg:127.17ms
step:105/1770 train_time:13346ms step_avg:127.10ms
step:106/1770 train_time:13466ms step_avg:127.04ms
step:107/1770 train_time:13595ms step_avg:127.06ms
step:108/1770 train_time:13715ms step_avg:126.99ms
step:109/1770 train_time:13833ms step_avg:126.91ms
step:110/1770 train_time:13951ms step_avg:126.82ms
step:111/1770 train_time:14074ms step_avg:126.79ms
step:112/1770 train_time:14196ms step_avg:126.75ms
step:113/1770 train_time:14311ms step_avg:126.65ms
step:114/1770 train_time:14437ms step_avg:126.64ms
step:115/1770 train_time:14556ms step_avg:126.57ms
step:116/1770 train_time:14674ms step_avg:126.50ms
step:117/1770 train_time:14793ms step_avg:126.44ms
step:118/1770 train_time:14919ms step_avg:126.43ms
step:119/1770 train_time:15042ms step_avg:126.40ms
step:120/1770 train_time:15164ms step_avg:126.37ms
step:121/1770 train_time:15291ms step_avg:126.37ms
step:122/1770 train_time:15411ms step_avg:126.32ms
step:123/1770 train_time:15530ms step_avg:126.26ms
step:124/1770 train_time:15647ms step_avg:126.19ms
step:125/1770 train_time:15768ms step_avg:126.15ms
step:126/1770 train_time:15892ms step_avg:126.13ms
step:127/1770 train_time:16015ms step_avg:126.10ms
step:128/1770 train_time:16141ms step_avg:126.10ms
step:129/1770 train_time:16273ms step_avg:126.15ms
step:130/1770 train_time:16396ms step_avg:126.12ms
step:131/1770 train_time:16520ms step_avg:126.11ms
step:132/1770 train_time:16639ms step_avg:126.05ms
step:133/1770 train_time:16759ms step_avg:126.01ms
step:134/1770 train_time:16880ms step_avg:125.97ms
step:135/1770 train_time:17002ms step_avg:125.94ms
step:136/1770 train_time:17118ms step_avg:125.87ms
step:137/1770 train_time:17238ms step_avg:125.83ms
step:138/1770 train_time:17360ms step_avg:125.79ms
step:139/1770 train_time:17479ms step_avg:125.75ms
step:140/1770 train_time:17615ms step_avg:125.82ms
step:141/1770 train_time:17745ms step_avg:125.85ms
step:142/1770 train_time:17861ms step_avg:125.78ms
step:143/1770 train_time:17983ms step_avg:125.75ms
step:144/1770 train_time:18103ms step_avg:125.71ms
step:145/1770 train_time:18233ms step_avg:125.75ms
step:146/1770 train_time:18354ms step_avg:125.71ms
step:147/1770 train_time:18476ms step_avg:125.69ms
step:148/1770 train_time:18602ms step_avg:125.69ms
step:149/1770 train_time:18721ms step_avg:125.64ms
step:150/1770 train_time:18842ms step_avg:125.62ms
step:151/1770 train_time:18963ms step_avg:125.58ms
step:152/1770 train_time:19086ms step_avg:125.56ms
step:153/1770 train_time:19204ms step_avg:125.52ms
step:154/1770 train_time:19324ms step_avg:125.48ms
step:155/1770 train_time:19442ms step_avg:125.43ms
step:156/1770 train_time:19558ms step_avg:125.37ms
[rank0]: Traceback (most recent call last):
[rank0]:   File "/data/wzx/modded-nanogpt-master/train_gpt.py", line 695, in <module>
[rank0]:     dist.all_reduce(param.grad, op=dist.ReduceOp.AVG)
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/distributed/c10d_logger.py", line 81, in wrapper
[rank0]:     return func(*args, **kwargs)
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/distributed/distributed_c10d.py", line 2822, in all_reduce
[rank0]:     work = group.allreduce([tensor], opts)
[rank0]: KeyboardInterrupt
