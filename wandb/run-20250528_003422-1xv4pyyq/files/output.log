logs/3493ddf7-1f2e-4b5f-a087-5845b5b6981a.txt
begin training
  2%|█▋                                                                                                   | 30/1771 [00:40<16:14,  1.79it/s]
step:0/1770 val_loss:10.8258 train_time:1ms step_avg:0.86ms
step:1/1770 train_time:520ms step_avg:519.93ms
step:2/1770 train_time:1013ms step_avg:506.25ms
step:3/1770 train_time:1559ms step_avg:519.78ms
step:4/1770 train_time:2105ms step_avg:526.24ms
step:5/1770 train_time:2653ms step_avg:530.65ms
step:6/1770 train_time:3202ms step_avg:533.60ms
step:7/1770 train_time:3750ms step_avg:535.73ms
step:8/1770 train_time:4302ms step_avg:537.75ms
step:9/1770 train_time:4851ms step_avg:538.97ms
step:10/1770 train_time:5409ms step_avg:540.88ms
step:11/1770 train_time:5969ms step_avg:542.62ms
step:12/1770 train_time:6526ms step_avg:543.87ms
step:13/1770 train_time:7089ms step_avg:545.29ms
step:14/1770 train_time:7647ms step_avg:546.24ms
step:15/1770 train_time:8209ms step_avg:547.28ms
step:16/1770 train_time:8771ms step_avg:548.16ms
step:17/1770 train_time:9324ms step_avg:548.49ms
step:18/1770 train_time:9886ms step_avg:549.23ms
step:19/1770 train_time:10444ms step_avg:549.69ms
step:20/1770 train_time:11002ms step_avg:550.12ms
step:21/1770 train_time:11563ms step_avg:550.62ms
step:22/1770 train_time:12121ms step_avg:550.94ms
step:23/1770 train_time:12678ms step_avg:551.24ms
step:24/1770 train_time:13236ms step_avg:551.50ms
step:25/1770 train_time:13794ms step_avg:551.77ms
step:26/1770 train_time:14353ms step_avg:552.05ms
step:27/1770 train_time:14912ms step_avg:552.31ms
step:28/1770 train_time:15470ms step_avg:552.50ms
step:29/1770 train_time:16029ms step_avg:552.74ms
step:30/1770 train_time:16590ms step_avg:553.01ms
step:31/1770 train_time:17144ms step_avg:553.04ms
step:32/1770 train_time:17707ms step_avg:553.34ms
step:33/1770 train_time:18267ms step_avg:553.55ms
step:34/1770 train_time:18823ms step_avg:553.63ms
step:35/1770 train_time:19385ms step_avg:553.86ms
step:36/1770 train_time:19947ms step_avg:554.07ms
step:37/1770 train_time:20508ms step_avg:554.26ms
step:38/1770 train_time:21067ms step_avg:554.39ms
step:39/1770 train_time:21628ms step_avg:554.58ms
step:40/1770 train_time:22188ms step_avg:554.70ms
step:41/1770 train_time:22744ms step_avg:554.72ms
step:42/1770 train_time:23306ms step_avg:554.91ms
step:43/1770 train_time:23865ms step_avg:555.00ms
step:44/1770 train_time:24424ms step_avg:555.10ms
step:45/1770 train_time:24986ms step_avg:555.25ms
step:46/1770 train_time:25550ms step_avg:555.43ms
step:47/1770 train_time:26113ms step_avg:555.60ms
step:48/1770 train_time:26681ms step_avg:555.85ms
step:49/1770 train_time:27244ms step_avg:556.01ms
step:50/1770 train_time:27808ms step_avg:556.16ms
step:51/1770 train_time:28371ms step_avg:556.29ms
step:52/1770 train_time:28935ms step_avg:556.45ms
step:53/1770 train_time:29503ms step_avg:556.65ms
step:54/1770 train_time:30060ms step_avg:556.67ms
step:55/1770 train_time:30626ms step_avg:556.84ms
step:56/1770 train_time:31190ms step_avg:556.97ms
step:57/1770 train_time:31756ms step_avg:557.13ms
step:58/1770 train_time:32324ms step_avg:557.30ms
step:59/1770 train_time:32887ms step_avg:557.41ms
step:60/1770 train_time:33453ms step_avg:557.55ms
step:61/1770 train_time:34022ms step_avg:557.73ms
step:62/1770 train_time:34586ms step_avg:557.84ms
step:63/1770 train_time:35150ms step_avg:557.93ms
step:64/1770 train_time:35720ms step_avg:558.12ms
step:65/1770 train_time:36284ms step_avg:558.22ms
step:66/1770 train_time:36852ms step_avg:558.36ms
step:67/1770 train_time:37421ms step_avg:558.52ms
step:68/1770 train_time:37987ms step_avg:558.64ms
step:69/1770 train_time:38559ms step_avg:558.83ms
step:70/1770 train_time:39128ms step_avg:558.97ms
step:71/1770 train_time:39695ms step_avg:559.09ms
step:72/1770 train_time:40261ms step_avg:559.18ms
step:73/1770 train_time:40832ms step_avg:559.34ms
step:74/1770 train_time:41401ms step_avg:559.48ms
step:75/1770 train_time:41969ms step_avg:559.58ms
step:76/1770 train_time:42541ms step_avg:559.75ms
step:77/1770 train_time:43107ms step_avg:559.83ms
step:78/1770 train_time:43678ms step_avg:559.98ms
step:79/1770 train_time:44248ms step_avg:560.10ms
step:80/1770 train_time:44819ms step_avg:560.23ms
step:81/1770 train_time:45387ms step_avg:560.33ms
step:82/1770 train_time:45959ms step_avg:560.47ms
step:83/1770 train_time:46527ms step_avg:560.56ms
step:84/1770 train_time:47101ms step_avg:560.72ms
step:85/1770 train_time:47668ms step_avg:560.80ms
step:86/1770 train_time:48237ms step_avg:560.89ms
step:87/1770 train_time:48805ms step_avg:560.98ms
step:88/1770 train_time:49374ms step_avg:561.07ms
step:89/1770 train_time:49942ms step_avg:561.15ms
step:90/1770 train_time:50516ms step_avg:561.29ms
step:91/1770 train_time:51089ms step_avg:561.41ms
step:92/1770 train_time:51657ms step_avg:561.49ms
step:93/1770 train_time:52232ms step_avg:561.63ms
step:94/1770 train_time:52798ms step_avg:561.68ms
step:95/1770 train_time:53372ms step_avg:561.81ms
step:96/1770 train_time:53943ms step_avg:561.91ms
step:97/1770 train_time:54515ms step_avg:562.01ms
step:98/1770 train_time:55085ms step_avg:562.09ms
step:99/1770 train_time:55657ms step_avg:562.20ms
step:100/1770 train_time:56234ms step_avg:562.34ms
step:101/1770 train_time:56806ms step_avg:562.43ms
step:102/1770 train_time:57377ms step_avg:562.52ms
step:103/1770 train_time:57954ms step_avg:562.66ms
step:104/1770 train_time:58522ms step_avg:562.71ms
step:105/1770 train_time:59095ms step_avg:562.81ms
step:106/1770 train_time:59671ms step_avg:562.93ms
step:107/1770 train_time:60244ms step_avg:563.03ms
step:108/1770 train_time:60813ms step_avg:563.09ms
step:109/1770 train_time:61392ms step_avg:563.23ms
step:110/1770 train_time:61969ms step_avg:563.36ms
step:111/1770 train_time:62542ms step_avg:563.45ms
step:112/1770 train_time:63118ms step_avg:563.55ms
step:113/1770 train_time:63695ms step_avg:563.67ms
step:114/1770 train_time:64271ms step_avg:563.78ms
step:115/1770 train_time:64850ms step_avg:563.91ms
step:116/1770 train_time:65421ms step_avg:563.97ms
step:117/1770 train_time:65997ms step_avg:564.08ms
step:118/1770 train_time:66572ms step_avg:564.17ms
step:119/1770 train_time:67150ms step_avg:564.28ms
step:120/1770 train_time:67726ms step_avg:564.38ms
step:121/1770 train_time:68305ms step_avg:564.50ms
step:122/1770 train_time:68879ms step_avg:564.58ms
step:123/1770 train_time:69455ms step_avg:564.67ms
step:124/1770 train_time:70032ms step_avg:564.78ms
step:125/1770 train_time:70614ms step_avg:564.91ms
step:125/1770 val_loss:4.9422 train_time:70623ms step_avg:564.99ms
step:126/1770 train_time:71199ms step_avg:565.07ms
step:127/1770 train_time:71775ms step_avg:565.15ms
step:128/1770 train_time:72341ms step_avg:565.16ms
step:129/1770 train_time:72916ms step_avg:565.24ms
step:130/1770 train_time:73492ms step_avg:565.33ms
step:131/1770 train_time:74063ms step_avg:565.37ms
step:132/1770 train_time:74634ms step_avg:565.41ms
step:133/1770 train_time:75215ms step_avg:565.53ms
step:134/1770 train_time:75794ms step_avg:565.63ms
step:135/1770 train_time:76374ms step_avg:565.74ms
step:136/1770 train_time:76953ms step_avg:565.83ms
step:137/1770 train_time:77535ms step_avg:565.95ms
step:138/1770 train_time:78111ms step_avg:566.02ms
step:139/1770 train_time:78692ms step_avg:566.13ms
step:140/1770 train_time:79268ms step_avg:566.20ms
step:141/1770 train_time:79844ms step_avg:566.27ms
step:142/1770 train_time:80424ms step_avg:566.36ms
step:143/1770 train_time:81004ms step_avg:566.46ms
step:144/1770 train_time:81584ms step_avg:566.56ms
step:145/1770 train_time:82157ms step_avg:566.60ms
step:146/1770 train_time:82735ms step_avg:566.68ms
step:147/1770 train_time:83315ms step_avg:566.77ms
step:148/1770 train_time:83892ms step_avg:566.84ms
step:149/1770 train_time:84473ms step_avg:566.93ms
step:150/1770 train_time:85054ms step_avg:567.02ms
step:151/1770 train_time:85634ms step_avg:567.11ms
step:152/1770 train_time:86216ms step_avg:567.21ms
step:153/1770 train_time:86795ms step_avg:567.29ms
step:154/1770 train_time:87379ms step_avg:567.40ms
step:155/1770 train_time:87961ms step_avg:567.49ms
step:156/1770 train_time:88543ms step_avg:567.59ms
step:157/1770 train_time:89128ms step_avg:567.69ms
step:158/1770 train_time:89713ms step_avg:567.80ms
step:159/1770 train_time:90292ms step_avg:567.87ms
step:160/1770 train_time:90878ms step_avg:567.99ms
step:161/1770 train_time:91461ms step_avg:568.08ms
step:162/1770 train_time:92043ms step_avg:568.17ms
step:163/1770 train_time:92634ms step_avg:568.31ms
step:164/1770 train_time:93214ms step_avg:568.38ms
step:165/1770 train_time:93805ms step_avg:568.52ms
step:166/1770 train_time:94389ms step_avg:568.61ms
step:167/1770 train_time:94975ms step_avg:568.71ms
step:168/1770 train_time:95559ms step_avg:568.80ms
step:169/1770 train_time:96139ms step_avg:568.87ms
step:170/1770 train_time:96727ms step_avg:568.99ms
step:171/1770 train_time:97309ms step_avg:569.06ms
step:172/1770 train_time:97893ms step_avg:569.14ms
step:173/1770 train_time:98477ms step_avg:569.23ms
step:174/1770 train_time:99059ms step_avg:569.30ms
step:175/1770 train_time:99643ms step_avg:569.39ms
step:176/1770 train_time:100228ms step_avg:569.48ms
step:177/1770 train_time:100809ms step_avg:569.54ms
step:178/1770 train_time:101392ms step_avg:569.62ms
step:179/1770 train_time:101978ms step_avg:569.71ms
step:180/1770 train_time:102566ms step_avg:569.81ms
step:181/1770 train_time:103150ms step_avg:569.89ms
step:182/1770 train_time:103735ms step_avg:569.97ms
step:183/1770 train_time:104323ms step_avg:570.07ms
step:184/1770 train_time:104909ms step_avg:570.16ms
step:185/1770 train_time:105494ms step_avg:570.24ms
step:186/1770 train_time:106085ms step_avg:570.35ms
step:187/1770 train_time:106669ms step_avg:570.42ms
step:188/1770 train_time:107256ms step_avg:570.51ms
step:189/1770 train_time:107844ms step_avg:570.60ms
step:190/1770 train_time:108429ms step_avg:570.68ms
step:191/1770 train_time:109013ms step_avg:570.75ms
step:192/1770 train_time:109605ms step_avg:570.86ms
step:193/1770 train_time:110192ms step_avg:570.94ms
step:194/1770 train_time:110785ms step_avg:571.06ms
step:195/1770 train_time:111375ms step_avg:571.15ms
step:196/1770 train_time:111966ms step_avg:571.25ms
step:197/1770 train_time:112555ms step_avg:571.35ms
step:198/1770 train_time:113144ms step_avg:571.43ms
step:199/1770 train_time:113737ms step_avg:571.54ms
step:200/1770 train_time:114326ms step_avg:571.63ms
step:201/1770 train_time:114915ms step_avg:571.72ms
step:202/1770 train_time:115505ms step_avg:571.81ms
step:203/1770 train_time:116099ms step_avg:571.91ms
step:204/1770 train_time:116688ms step_avg:572.00ms
step:205/1770 train_time:117279ms step_avg:572.09ms
step:206/1770 train_time:117868ms step_avg:572.18ms
step:207/1770 train_time:118457ms step_avg:572.26ms
step:208/1770 train_time:119049ms step_avg:572.35ms
step:209/1770 train_time:119640ms step_avg:572.44ms
step:210/1770 train_time:120225ms step_avg:572.50ms
step:211/1770 train_time:120819ms step_avg:572.60ms
step:212/1770 train_time:121409ms step_avg:572.68ms
step:213/1770 train_time:122002ms step_avg:572.78ms
step:214/1770 train_time:122590ms step_avg:572.85ms
step:215/1770 train_time:123184ms step_avg:572.95ms
step:216/1770 train_time:123774ms step_avg:573.03ms
step:217/1770 train_time:124363ms step_avg:573.10ms
step:218/1770 train_time:124951ms step_avg:573.17ms
step:219/1770 train_time:125537ms step_avg:573.23ms
step:220/1770 train_time:126129ms step_avg:573.31ms
step:221/1770 train_time:126720ms step_avg:573.39ms
step:222/1770 train_time:127317ms step_avg:573.50ms
step:223/1770 train_time:127903ms step_avg:573.56ms
step:224/1770 train_time:128499ms step_avg:573.66ms
step:225/1770 train_time:129091ms step_avg:573.74ms
step:226/1770 train_time:129682ms step_avg:573.81ms
step:227/1770 train_time:130274ms step_avg:573.89ms
step:228/1770 train_time:130866ms step_avg:573.97ms
step:229/1770 train_time:131461ms step_avg:574.06ms
step:230/1770 train_time:132056ms step_avg:574.15ms
step:231/1770 train_time:132650ms step_avg:574.24ms
step:232/1770 train_time:133239ms step_avg:574.31ms
step:233/1770 train_time:133834ms step_avg:574.40ms
step:234/1770 train_time:134429ms step_avg:574.48ms
step:235/1770 train_time:135024ms step_avg:574.57ms
step:236/1770 train_time:135620ms step_avg:574.66ms
step:237/1770 train_time:136214ms step_avg:574.74ms
step:238/1770 train_time:136808ms step_avg:574.82ms
step:239/1770 train_time:137398ms step_avg:574.89ms
step:240/1770 train_time:137995ms step_avg:574.98ms
step:241/1770 train_time:138588ms step_avg:575.05ms
step:242/1770 train_time:139182ms step_avg:575.13ms
step:243/1770 train_time:139779ms step_avg:575.22ms
step:244/1770 train_time:140378ms step_avg:575.32ms
step:245/1770 train_time:140974ms step_avg:575.41ms
step:246/1770 train_time:141567ms step_avg:575.48ms
step:247/1770 train_time:142160ms step_avg:575.55ms
step:248/1770 train_time:142756ms step_avg:575.63ms
step:249/1770 train_time:143354ms step_avg:575.72ms
step:250/1770 train_time:143944ms step_avg:575.78ms
step:250/1770 val_loss:4.3564 train_time:143955ms step_avg:575.82ms
step:251/1770 train_time:144545ms step_avg:575.88ms
step:252/1770 train_time:145130ms step_avg:575.91ms
step:253/1770 train_time:145722ms step_avg:575.97ms
step:254/1770 train_time:146306ms step_avg:576.01ms
step:255/1770 train_time:146893ms step_avg:576.05ms
step:256/1770 train_time:147481ms step_avg:576.10ms
step:257/1770 train_time:148069ms step_avg:576.14ms
step:258/1770 train_time:148658ms step_avg:576.19ms
step:259/1770 train_time:149248ms step_avg:576.25ms
step:260/1770 train_time:149829ms step_avg:576.27ms
step:261/1770 train_time:150420ms step_avg:576.32ms
step:262/1770 train_time:151006ms step_avg:576.36ms
[rank0]: Traceback (most recent call last):
[rank0]:   File "/data/wzx/modded-nanogpt-master/train_gpt.py", line 729, in <module>
[rank0]:     opt.step()
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/optim/optimizer.py", line 485, in wrapper
[rank0]:     out = func(*args, **kwargs)
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
[rank0]:     return func(*args, **kwargs)
[rank0]:   File "/data/wzx/modded-nanogpt-master/train_gpt.py", line 274, in step
[rank0]:     handle = dist.all_gather_into_tensor(update_buffer, g_muon, async_op=True)
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/distributed/c10d_logger.py", line 81, in wrapper
[rank0]:     return func(*args, **kwargs)
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/distributed/distributed_c10d.py", line 3864, in all_gather_into_tensor
[rank0]:     work = group._allgather_base(output_tensor, input_tensor, opts)
[rank0]: KeyboardInterrupt
