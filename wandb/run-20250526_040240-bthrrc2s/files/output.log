logs/3b33b07e-6e44-44c7-82e3-e644575585f9.txt
[rank0]: Traceback (most recent call last):
[rank0]:   File "/data/wzx/modded-nanogpt-master/train_gpt.py", line 637, in <module>
[rank0]:     model(inputs.to(torch.int32), targets, get_window_size_blocks(0)).backward()
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py", line 655, in _fn
[rank0]:     return fn(*args, **kwargs)
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 1429, in __call__
[rank0]:     return self._torchdynamo_orig_callable(
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 1210, in __call__
[rank0]:     result = self._inner_convert(
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 597, in __call__
[rank0]:     return _compile(
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 1056, in _compile
[rank0]:     guarded_code = compile_inner(code, one_graph, hooks, transform)
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/_utils_internal.py", line 97, in wrapper_function
[rank0]:     return function(*args, **kwargs)
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 758, in compile_inner
[rank0]:     return _compile_inner(code, one_graph, hooks, transform)
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 794, in _compile_inner
[rank0]:     out_code = transform_code_object(code, transform)
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/_dynamo/bytecode_transformation.py", line 1422, in transform_code_object
[rank0]:     transformations(instructions, code_options)
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 256, in _fn
[rank0]:     return fn(*args, **kwargs)
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 712, in transform
[rank0]:     tracer.run()
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 3335, in run
[rank0]:     super().run()
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 1236, in run
[rank0]:     while self.step():
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 1146, in step
[rank0]:     self.dispatch_table[inst.opcode](self, inst)
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 3531, in RETURN_VALUE
[rank0]:     self._return(inst)
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 3516, in _return
[rank0]:     self.output.compile_subgraph(
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/_dynamo/output_graph.py", line 1141, in compile_subgraph
[rank0]:     self.compile_and_call_fx_graph(
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/_dynamo/output_graph.py", line 1434, in compile_and_call_fx_graph
[rank0]:     compiled_fn = self.call_user_compiler(gm)
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/_dynamo/output_graph.py", line 1484, in call_user_compiler
[rank0]:     return self._call_user_compiler(gm)
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/_dynamo/output_graph.py", line 1516, in _call_user_compiler
[rank0]:     compiled_fn = compiler_fn(gm, self.example_inputs())
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/_dynamo/repro/after_dynamo.py", line 150, in __call__
[rank0]:     compiled_gm = compiler_fn(gm, example_inputs)
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/__init__.py", line 2349, in __call__
[rank0]:     return compile_fx(model_, inputs_, config_patches=self.config)
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/_inductor/compile_fx.py", line 2087, in compile_fx
[rank0]:     return aot_autograd(
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/_dynamo/backends/common.py", line 101, in __call__
[rank0]:     cg = aot_module_simplified(gm, example_inputs, **self.kwargs)
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/_functorch/aot_autograd.py", line 1160, in aot_module_simplified
[rank0]:     compiled_fn = AOTAutogradCache.load(
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/_functorch/_aot_autograd/autograd_cache.py", line 775, in load
[rank0]:     compiled_fn = dispatch_and_compile()
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/_functorch/aot_autograd.py", line 1145, in dispatch_and_compile
[rank0]:     compiled_fn, _ = create_aot_dispatcher_function(
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/_functorch/aot_autograd.py", line 570, in create_aot_dispatcher_function
[rank0]:     return _create_aot_dispatcher_function(
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/_functorch/aot_autograd.py", line 820, in _create_aot_dispatcher_function
[rank0]:     compiled_fn, fw_metadata = compiler_fn(
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/_functorch/_aot_autograd/jit_compile_runtime_wrappers.py", line 783, in aot_dispatch_autograd
[rank0]:     fx_g, joint_inputs, maybe_subclass_meta = aot_dispatch_autograd_graph(
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/_functorch/_aot_autograd/dispatch_and_compile_graph.py", line 318, in aot_dispatch_autograd_graph
[rank0]:     fx_g = _create_graph(joint_fn_to_trace, updated_joint_inputs, aot_config=aot_config)
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/_functorch/_aot_autograd/dispatch_and_compile_graph.py", line 55, in _create_graph
[rank0]:     fx_g = make_fx(
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/fx/experimental/proxy_tensor.py", line 2240, in wrapped
[rank0]:     return make_fx_tracer.trace(f, *args)
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/fx/experimental/proxy_tensor.py", line 2178, in trace
[rank0]:     return self._trace_inner(f, *args)
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/fx/experimental/proxy_tensor.py", line 2149, in _trace_inner
[rank0]:     t = dispatch_trace(
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/_compile.py", line 51, in inner
[rank0]:     return disable_fn(*args, **kwargs)
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py", line 838, in _fn
[rank0]:     return fn(*args, **kwargs)
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/fx/experimental/proxy_tensor.py", line 1174, in dispatch_trace
[rank0]:     graph = tracer.trace(root, concrete_args)  # type: ignore[arg-type]
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py", line 838, in _fn
[rank0]:     return fn(*args, **kwargs)
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/fx/_symbolic_trace.py", line 838, in trace
[rank0]:     (self.create_arg(fn(*args)),),
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/fx/_symbolic_trace.py", line 692, in flatten_fn
[rank0]:     tree_out = root_fn(*tree_args)
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/fx/experimental/proxy_tensor.py", line 1229, in wrapped
[rank0]:     out = f(*tensors)  # type:ignore[call-arg]
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/_functorch/_aot_autograd/traced_function_transforms.py", line 717, in inner_fn
[rank0]:     outs = fn(*args)
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/_functorch/_aot_autograd/traced_function_transforms.py", line 668, in joint_helper
[rank0]:     return _functionalized_f_helper(primals, tangents)
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/_functorch/_aot_autograd/traced_function_transforms.py", line 416, in _functionalized_f_helper
[rank0]:     f_outs = fn(*f_args)
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/_functorch/_aot_autograd/traced_function_transforms.py", line 283, in inner_fn_with_anomaly
[rank0]:     return inner_fn(*args)
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/_functorch/_aot_autograd/traced_function_transforms.py", line 197, in inner_fn
[rank0]:     outs, tangent_mask = fn(*primals)
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/_functorch/_aot_autograd/traced_function_transforms.py", line 118, in inner_fn
[rank0]:     outs = fn(*args_maybe_cloned)
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/_functorch/_aot_autograd/traced_function_transforms.py", line 899, in functional_call
[rank0]:     out = PropagateUnbackedSymInts(mod).run(
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/fx/interpreter.py", line 171, in run
[rank0]:     self.env[node] = self.run_node(node)
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/fx/experimental/symbolic_shapes.py", line 7157, in run_node
[rank0]:     result = super().run_node(n)
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/fx/interpreter.py", line 240, in run_node
[rank0]:     return getattr(self, n.op)(n.target, args, kwargs)
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/fx/interpreter.py", line 344, in call_method
[rank0]:     return getattr(self_obj, target)(*args_tail, **kwargs)
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/_subclasses/functional_tensor.py", line 266, in to
[rank0]:     return super().to(*args, **kwargs)
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/fx/experimental/proxy_tensor.py", line 1277, in __torch_function__
[rank0]:     return func(*args, **kwargs)
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/_subclasses/functional_tensor.py", line 525, in __torch_dispatch__
[rank0]:     outs_unwrapped = func._op_dk(
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/utils/_stats.py", line 27, in wrapper
[rank0]:     return fn(*args, **kwargs)
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/fx/experimental/proxy_tensor.py", line 1379, in __torch_dispatch__
[rank0]:     return proxy_call(self, func, self.pre_dispatch, args, kwargs)
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/fx/experimental/proxy_tensor.py", line 791, in proxy_call
[rank0]:     r = maybe_handle_decomp(proxy_mode, func, args, kwargs)
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/fx/experimental/proxy_tensor.py", line 2308, in maybe_handle_decomp
[rank0]:     out = CURRENT_DECOMPOSITION_TABLE[op](*args, **kwargs)
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/_prims_common/wrappers.py", line 308, in _fn
[rank0]:     result = fn(*args, **kwargs)
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/_decomp/decompositions.py", line 2127, in _to_copy
[rank0]:     x_tensor = torch._prims.convert_element_type(x_tensor, dtype)
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/_ops.py", line 756, in __call__
[rank0]:     return self._op(*args, **kwargs)
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/utils/_stats.py", line 27, in wrapper
[rank0]:     return fn(*args, **kwargs)
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/fx/experimental/proxy_tensor.py", line 1379, in __torch_dispatch__
[rank0]:     return proxy_call(self, func, self.pre_dispatch, args, kwargs)
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/fx/experimental/proxy_tensor.py", line 914, in proxy_call
[rank0]:     out = func(*args, **kwargs)
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/_ops.py", line 756, in __call__
[rank0]:     return self._op(*args, **kwargs)
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/utils/_stats.py", line 27, in wrapper
[rank0]:     return fn(*args, **kwargs)
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/_subclasses/fake_tensor.py", line 1282, in __torch_dispatch__
[rank0]:     return self.dispatch(func, types, args, kwargs)
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/_subclasses/fake_tensor.py", line 1823, in dispatch
[rank0]:     return self._cached_dispatch_impl(func, types, args, kwargs)
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/_subclasses/fake_tensor.py", line 1368, in _cached_dispatch_impl
[rank0]:     key = self._cache_key(state, func, args, kwargs)
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/_subclasses/fake_tensor.py", line 1426, in _cache_key
[rank0]:     self._prep_args_for_hash(key_values, args, state)
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/_subclasses/fake_tensor.py", line 1503, in _prep_args_for_hash
[rank0]:     metadata._flatten_into(result, self, state)
[rank0]:   File "/data/wzx/miniconda3/envs/nanogpt/lib/python3.10/site-packages/torch/_subclasses/fake_tensor.py", line 974, in _flatten_into
[rank0]:     elif isinstance(value, SymInt):
[rank0]: KeyboardInterrupt
